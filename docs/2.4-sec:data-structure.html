<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.4 Data structure | Visualization and analysis of probability distributions of large temporal data</title>
  <meta name="description" content="2.4 Data structure | Visualization and analysis of probability distributions of large temporal data" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2.4 Data structure | Visualization and analysis of probability distributions of large temporal data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.4 Data structure | Visualization and analysis of probability distributions of large temporal data" />
  
  
  

<meta name="author" content="Sayani Gupta" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="2.3-sec:cyclic-gran.html"/>
<link rel="next" href="2.5-sec:visualization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="template/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./"> </a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="ch:abstract.html"><a href="ch:abstract.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="ch:thanks.html"><a href="ch:thanks.html"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="ch:preface.html"><a href="ch:preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="1-ch:intro.html"><a href="1-ch:intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="1.1-sec:gravitas.html"><a href="1.1-sec:gravitas.html"><i class="fa fa-check"></i><b>1.1</b> Visualizing probability distributions across bivariate cyclic temporal granularities</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-sec:hakear.html"><a href="1.2-sec:hakear.html"><i class="fa fa-check"></i><b>1.2</b> Detecting distributional differences between temporal granularities for exploratory time series analysis</a></li>
<li class="chapter" data-level="1.3" data-path="1.3-sec:gracsr.html"><a href="1.3-sec:gracsr.html"><i class="fa fa-check"></i><b>1.3</b> Clustering time series based on probability distributions across temporal granularities</a></li>
<li class="chapter" data-level="1.4" data-path="1.4-summary.html"><a href="1.4-summary.html"><i class="fa fa-check"></i><b>1.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-ch:gravitas.html"><a href="2-ch:gravitas.html"><i class="fa fa-check"></i><b>2</b> Visualizing probability distributions across bivariate cyclic temporal granularities</a><ul>
<li class="chapter" data-level="2.1" data-path="2.1-introduction.html"><a href="2.1-introduction.html"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="2.2-sec:linear-time.html"><a href="2.2-sec:linear-time.html"><i class="fa fa-check"></i><b>2.2</b> Linear time granularities</a></li>
<li class="chapter" data-level="2.3" data-path="2.3-sec:cyclic-gran.html"><a href="2.3-sec:cyclic-gran.html"><i class="fa fa-check"></i><b>2.3</b> Cyclic time granularities</a></li>
<li class="chapter" data-level="2.4" data-path="2.4-sec:data-structure.html"><a href="2.4-sec:data-structure.html"><i class="fa fa-check"></i><b>2.4</b> Data structure</a></li>
<li class="chapter" data-level="2.5" data-path="2.5-sec:visualization.html"><a href="2.5-sec:visualization.html"><i class="fa fa-check"></i><b>2.5</b> Visualization</a></li>
<li class="chapter" data-level="2.6" data-path="2.6-sec:application.html"><a href="2.6-sec:application.html"><i class="fa fa-check"></i><b>2.6</b> Applications</a></li>
<li class="chapter" data-level="2.7" data-path="2.7-sec:discussion.html"><a href="2.7-sec:discussion.html"><i class="fa fa-check"></i><b>2.7</b> Discussion</a></li>
<li class="chapter" data-level="" data-path="thanksgravitas.html"><a href="thanksgravitas.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="supplement-gravitas.html"><a href="supplement-gravitas.html"><i class="fa fa-check"></i>Supplementary Materials</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-ch:hakear.html"><a href="3-ch:hakear.html"><i class="fa fa-check"></i><b>3</b> Detecting distributional differences between temporal granularities for exploratory time series analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="3.1-introduction-1.html"><a href="3.1-introduction-1.html"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="3.2-sec:computation-wpd.html"><a href="3.2-sec:computation-wpd.html"><i class="fa fa-check"></i><b>3.2</b> Proposed distance measure</a></li>
<li class="chapter" data-level="3.3" data-path="3.3-sec:rank-wpd.html"><a href="3.3-sec:rank-wpd.html"><i class="fa fa-check"></i><b>3.3</b> Ranking and selection of cyclic granularities</a></li>
<li class="chapter" data-level="3.4" data-path="3.4-sec:application-wpd.html"><a href="3.4-sec:application-wpd.html"><i class="fa fa-check"></i><b>3.4</b> Application to residential smart meter dataset</a></li>
<li class="chapter" data-level="3.5" data-path="3.5-discussion.html"><a href="3.5-discussion.html"><i class="fa fa-check"></i><b>3.5</b> Discussion</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="3.6" data-path="3.6-supplementary-materials.html"><a href="3.6-supplementary-materials.html"><i class="fa fa-check"></i><b>3.6</b> Supplementary Materials</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-ch:gracsr.html"><a href="4-ch:gracsr.html"><i class="fa fa-check"></i><b>4</b> Clustering time series based on probability distributions across temporal granularities</a><ul>
<li class="chapter" data-level="4.1" data-path="4.1-introduction-2.html"><a href="4.1-introduction-2.html"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="4.2-sec:methodology.html"><a href="4.2-sec:methodology.html"><i class="fa fa-check"></i><b>4.2</b> Clustering methodology</a></li>
<li class="chapter" data-level="4.3" data-path="4.3-sec:validation.html"><a href="4.3-sec:validation.html"><i class="fa fa-check"></i><b>4.3</b> Validation</a></li>
<li class="chapter" data-level="4.4" data-path="4.4-sec:cases.html"><a href="4.4-sec:cases.html"><i class="fa fa-check"></i><b>4.4</b> Case study</a></li>
<li class="chapter" data-level="4.5" data-path="4.5-sec:conclusion.html"><a href="4.5-sec:conclusion.html"><i class="fa fa-check"></i><b>4.5</b> Conclusion and future work</a></li>
<li class="chapter" data-level="" data-path="thanksgracsr.html"><a href="thanksgracsr.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="supplement-gracsr.html"><a href="supplement-gracsr.html"><i class="fa fa-check"></i>Supplementary Materials</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-ch:conclusion.html"><a href="5-ch:conclusion.html"><i class="fa fa-check"></i><b>5</b> Conclusion and future plans</a><ul>
<li class="chapter" data-level="5.1" data-path="5.1-software-development.html"><a href="5.1-software-development.html"><i class="fa fa-check"></i><b>5.1</b> Software development</a></li>
<li class="chapter" data-level="5.2" data-path="5.2-future-work.html"><a href="5.2-future-work.html"><i class="fa fa-check"></i><b>5.2</b> Future work</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch:appendix.html"><a href="ch:appendix.html"><i class="fa fa-check"></i>Appendix</a></li>
<li class="chapter" data-level="6" data-path="6-supplementary-chapter-3.html"><a href="6-supplementary-chapter-3.html"><i class="fa fa-check"></i><b>6</b> Supplementary: Chapter 3</a><ul>
<li class="chapter" data-level="6.1" data-path="6.1-recalling-notations.html"><a href="6.1-recalling-notations.html"><i class="fa fa-check"></i><b>6.1</b> Recalling notations</a></li>
<li class="chapter" data-level="6.2" data-path="6.2-raw-weighted-pairwise-distance.html"><a href="6.2-raw-weighted-pairwise-distance.html"><i class="fa fa-check"></i><b>6.2</b> Raw weighted pairwise distance</a></li>
<li class="chapter" data-level="6.3" data-path="6.3-adjusted-weighted-pairwise-distances.html"><a href="6.3-adjusted-weighted-pairwise-distances.html"><i class="fa fa-check"></i><b>6.3</b> Adjusted weighted pairwise distances</a></li>
<li class="chapter" data-level="6.4" data-path="6.4-ranking-and-selecting-harmonies.html"><a href="6.4-ranking-and-selecting-harmonies.html"><i class="fa fa-check"></i><b>6.4</b> Ranking and selecting harmonies</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-supplementary-chapter-4.html"><a href="7-supplementary-chapter-4.html"><i class="fa fa-check"></i><b>7</b> Supplementary: Chapter 4</a><ul>
<li class="chapter" data-level="7.1" data-path="7.1-raw-data-plot.html"><a href="7.1-raw-data-plot.html"><i class="fa fa-check"></i><b>7.1</b> Raw data plot</a></li>
<li class="chapter" data-level="7.2" data-path="7.2-missing-data-plot.html"><a href="7.2-missing-data-plot.html"><i class="fa fa-check"></i><b>7.2</b> Missing data plot</a></li>
<li class="chapter" data-level="7.3" data-path="7.3-prototype-selection.html"><a href="7.3-prototype-selection.html"><i class="fa fa-check"></i><b>7.3</b> Prototype selection</a></li>
<li class="chapter" data-level="7.4" data-path="7.4-interaction-of-granularities-1.html"><a href="7.4-interaction-of-granularities-1.html"><i class="fa fa-check"></i><b>7.4</b> Interaction of granularities</a></li>
<li class="chapter" data-level="7.5" data-path="7.5-clustering-353-customers.html"><a href="7.5-clustering-353-customers.html"><i class="fa fa-check"></i><b>7.5</b> Clustering 353 customers</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><strong><a href="https://github.com/rstudio/bookdown" target="blank">Proudly published with bookdown</a></strong></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Visualization and analysis of probability distributions of large temporal data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec:data-structure" class="section level2">
<h2><span class="header-section-number">2.4</span> Data structure</h2>
<p>Effective exploration and visualization benefit from well-organized data structures. <span class="citation">E. Wang, Cook, and Hyndman (<a href="bibliography.html#ref-wang2020tsibble" role="doc-biblioref">2020</a><a href="bibliography.html#ref-wang2020tsibble" role="doc-biblioref">a</a>)</span> introduced the tidy “tsibble” data structure to support exploration and modeling of temporal data. This forms the basis of the structure for cyclic granularities. A tsibble comprises an index, optional key(s), and measured variables. An index is a variable with inherent ordering from past to present and a key is a set of variables that define observational units over time. A linear granularity is a mapping of the index set to subsets of the time domain. For example, if the index of a tsibble is days, then a linear granularity might be weeks, months or years. A bottom granularity is represented by the index of the tsibble.</p>



<p>All cyclic granularities can be expressed in terms of the index set.  shows the tsibble structure (index, key, measurements) augmented by columns of cyclic granularities. The total number of cyclic granularities depends on the number of linear granularities considered in the hierarchy table and the presence of any aperiodic cyclic granularities. For example, if we have <span class="math inline">\(n\)</span> periodic linear granularities in the hierarchy table, then <span class="math inline">\(n(n-1)/2\)</span> circular or quasi-circular cyclic granularities can be constructed. Let <span class="math inline">\(N_C\)</span> be the total number of contextual circular, quasi-circular and aperiodic cyclic granularities that can originate from the underlying periodic and aperiodic linear granularities. Simultaneously encoding more than a few of these cyclic granularities when visualizing the data overwhelms human comprehension. Instead, we focus on visualizing the data split by pairs of cyclic granularities (<span class="math inline">\(C_i\)</span>, <span class="math inline">\(C_j\)</span>). Data sets of the form &lt;<span class="math inline">\(C_i\)</span>, <span class="math inline">\(C_j\)</span>, <span class="math inline">\(v\)</span>&gt; then allow exploration and analysis of the measured variable <span class="math inline">\(v\)</span>.</p>
<div id="sec:synergy" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Harmonies and clashes</h3>
<p>The way granularities are related is important when we consider data visualizations. Consider two cyclic granularities <span class="math inline">\(C_i\)</span> and <span class="math inline">\(C_j\)</span>, such that <span class="math inline">\(C_i\)</span> maps index set to a set <span class="math inline">\(\{A_k \mid k=1,\dots,K\}\)</span> and <span class="math inline">\(C_j\)</span> maps index set to a set <span class="math inline">\(\{B_\ell \mid \ell =1,\dots,L\}\)</span>. Here, <span class="math inline">\(A_k\)</span> and <span class="math inline">\(B_\ell\)</span> are the levels/categories corresponding to <span class="math inline">\(C_i\)</span> and <span class="math inline">\(C_j\)</span> respectively. Let <span class="math inline">\(S_{k\ell}\)</span> be a subset of the index set such that for all <span class="math inline">\(s \in S_{k\ell}\)</span>, <span class="math inline">\(C_i(s) = A_k\)</span> and <span class="math inline">\(C_j(s) = B_\ell\)</span>. There are <span class="math inline">\(KL\)</span> such data subsets, one for each combination of levels (<span class="math inline">\(A_k\)</span>, <span class="math inline">\(B_\ell\)</span>). Some of these sets may be empty due to the structure of the calendar, or because of the duration and location of events in a calendar.</p>


<p>Structurally empty combinations can arise due to the structure of the calendar or hierarchy. For example, let <span class="math inline">\(C_i\)</span> be day-of-month with 31 levels and <span class="math inline">\(C_j\)</span> be day-of-year with 365 levels. There will be <span class="math inline">\(31\times 365=11315\)</span> sets <span class="math inline">\(S_{k\ell}\)</span> corresponding to possible combinations of <span class="math inline">\(C_i\)</span> and <span class="math inline">\(C_j\)</span>. Many of these are empty. For example, <span class="math inline">\(S_{1,5}\)</span> is empty because the first day of the month can never correspond to the fifth day of the year. Hence the pair (day-of-month, day-of-year) is a clash.</p>
<p>Event-driven empty combinations arise due to differences in event location or duration in a calendar. For example, let <span class="math inline">\(C_i\)</span> be day-of-week with 7 levels and <span class="math inline">\(C_j\)</span> be working-day/non-working-day with 2 levels. While potentially all of these 14 sets <span class="math inline">\(S_{k\ell}\)</span> can be non-empty (it is possible to have a public holiday on any day-of-week), in practice many of these will probably have very few observations. For example, there are few (if any) public holidays on Wednesdays or Thursdays in any given year in Melbourne, Australia.</p>
<p>An example of harmony is where <span class="math inline">\(C_i\)</span> and <span class="math inline">\(C_j\)</span> denote day-of-week and month-of-year respectively. So <span class="math inline">\(C_i\)</span> will have 7 levels while <span class="math inline">\(C_j\)</span> will have 12 levels, giving <span class="math inline">\(12\times7=84\)</span> sets <span class="math inline">\(S_{k\ell}\)</span>. All of these are non-empty because every day-of-week can occur in every month. Hence, the pair (day-of-week, month-of-year) is a harmony.</p>
</div>
<div id="sec:near-clashes" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Near-clashes</h3>
<p>Suppose <span class="math inline">\(C_i\)</span> denotes day-of-year and <span class="math inline">\(C_j\)</span> denotes day-of-week. While any day of the week can occur on any day of the year, some combinations will be very rare. For example, the 366th day of the year will only coincide with a Wednesday approximately every 28 years on average. We refer to these as “near-clashes”.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2.3-sec:cyclic-gran.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2.5-sec:visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/earowang/thesis/edit/master/Rmd//02-gravitas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
